# RocketDoo Deploy Configuration
# Generated by: rkd deploy init

# ============================================================
# Module Configuration
# ============================================================
modules:
  # Auto-detect all modules with __manifest__.py in addons/
  auto_detect: true
  
  # Base path for addons (relative to project root)
  base_path: "addons"
  
  # Patterns to exclude from deployment
  exclude_patterns:
    - "*/tests/*"
    - "*/__pycache__/*"
    - "*/.git/*"
    - "*/node_modules/*"
    - "*.pyc"
    - "*.pyo"
  
  # Explicit module list (only used if auto_detect: false)
  # include_only:
  #   - my_module_1
  #   - package/my_module_2

# ============================================================
# Deployment Targets
# ============================================================
targets:
  
  # Example: VPS with Docker
  # production:
  #   type: vps
  #   enabled: true
  #   
  #   # SSH Connection
  #   connection:
  #     host: "192.168.1.100"
  #     port: 22
  #     user: "odoo"
  #     ssh_key: "~/.ssh/id_rsa"
  #     # password: "${VPS_PASSWORD}"  # Use env var for password
  #   
  #   # Deployment type: docker or native
  #   deployment_type: docker
  #   
  #   # Docker-specific configuration
  #   docker:
  #     container_name: "odoo"
  #     compose_path: "/opt/odoo"
  #     addons_mount: "/mnt/extra-addons"
  #   
  #   # Post-deploy actions
  #   post_deploy:
  #     restart_service: true
  #     update_modules: true
  #     run_tests: false
  #     custom_commands: []
  
  # Example: VPS with Native Installation
  # staging:
  #   type: vps
  #   enabled: true
  #   
  #   connection:
  #     host: "staging.example.com"
  #     port: 22
  #     user: "odoo"
  #     ssh_key: "~/.ssh/id_rsa"
  #   
  #   deployment_type: native
  #   
  #   # Native installation configuration
  #   native:
  #     odoo_path: "/opt/odoo"
  #     addons_path: "/opt/odoo/custom_addons"
  #     service_name: "odoo"
  #     python_env: "/opt/odoo/venv/bin/python"
  #   
  #   post_deploy:
  #     restart_service: true
  #     update_modules: true
  #     custom_commands:
  #       - "sudo systemctl restart odoo"
  
  # Example: Odoo.sh
  # odoo_sh_test:
  #   type: odoo-sh
  #   enabled: true
  #   
  #   # Odoo.sh configuration
  #   odoo_sh:
  #     project_id: "my-project"
  #     branch: "test"
  #     
  #     # Option 1: Use API (requires token)
  #     api_token: "${ODOO_SH_TOKEN}"
  #     
  #     # Option 2: Use Git push
  #     # git_remote: "origin"
  #     # git_url: "git@github.com:username/odoo-sh-project.git"
  #   
  #   # Odoo.sh repository structure
  #   structure:
  #     custom_addons_path: "."
  #   
  #   post_deploy:
  #     wait_for_build: true
  #     open_browser: false
  
  # Example: Production with safety checks
  # production:
  #   type: vps
  #   enabled: false  # Disabled by default for safety
  #   
  #   # Require explicit confirmation
  #   require_confirmation: true
  #   
  #   # Only allow tagged releases
  #   require_git_tag: true
  #   
  #   connection:
  #     host: "production.example.com"
  #     port: 22
  #     user: "odoo"
  #     ssh_key: "~/.ssh/id_rsa"
  #   
  #   deployment_type: docker
  #   
  #   docker:
  #     container_name: "odoo"
  #     compose_path: "/opt/odoo"
  #     addons_mount: "/mnt/extra-addons"
  #   
  #   post_deploy:
  #     restart_service: true
  #     update_modules: true
  #     run_tests: false
  #     # Send notification after deploy
  #     notify_email: "admin@example.com"

# ============================================================
# Backup Configuration
# ============================================================
backup:
  enabled: true
  keep_last: 3
  path: ".rkd/deploy_backups"

# ============================================================
# Pre-Deploy Validations
# ============================================================
validations:
  check_manifest: true
  check_python_syntax: true
  check_xml_syntax: true
  check_dependencies: true
  run_tests: false

# ============================================================
# Logging Configuration
# ============================================================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  file: ".rkd/deploy.log"
  console: true